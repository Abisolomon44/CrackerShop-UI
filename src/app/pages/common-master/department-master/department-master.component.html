<div class="container mt-4">
  <h2 class="mb-4">Department Master</h2>

  <!-- Department Form -->
  <form (ngSubmit)="saveDepartment()">
    <div class="row mb-3">

      <!-- Branch Dropdown -->
      <div class="col-md-3">
        <label class="form-label">Branch</label>
        <select [(ngModel)]="department.branchID" name="branchID" class="form-select" required>
          <option value="" disabled>Select Branch</option>
          <option *ngFor="let branch of branches" [value]="branch.branchID">
            {{ branch.branchName }}
          </option>
        </select>
      </div>

      <!-- Department Code -->
      <div class="col-md-3">
        <label class="form-label">Department Code</label>
        <input type="text" [(ngModel)]="department.departmentCode" name="departmentCode" class="form-control" required>
      </div>

      <!-- Department Name -->
      <div class="col-md-3">
        <label class="form-label">Department Name</label>
        <input type="text" [(ngModel)]="department.departmentName" name="departmentName" class="form-control" required>
      </div>

      <!-- Active Checkbox -->
      <div class="col-md-2 d-flex align-items-center mt-4">
        <div class="form-check">
          <input type="checkbox" [(ngModel)]="department.isActive" name="isActive" class="form-check-input" id="activeCheck">
          <label class="form-check-label" for="activeCheck">Active</label>
        </div>
      </div>

      <!-- Save / Update Button -->
      <div class="col-md-1 d-flex align-items-center mt-4">
        <button type="submit" class="btn btn-primary">
          {{ department.departmentID ? 'Update' : 'Save' }}
        </button>
      </div>

    </div>

    <!-- Cancel Button -->
    <div class="mb-3">
      <button type="button" class="btn btn-secondary" (click)="cancelEdit()">Cancel</button>
    </div>
  </form>

  <hr>

  <!-- Department Table -->
  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th>ID</th>
        <th>Branch</th>
        <th>Code</th>
        <th>Name</th>
        <th>Active</th>
        <th class="text-center">Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let dept of departments">
        <td>{{ dept.departmentID }}</td>
        <td>{{ getBranchName(dept.branchID) }}</td>
        <td>{{ dept.departmentCode }}</td>
        <td>{{ dept.departmentName }}</td>
        <td>
          <span class="badge" [class.bg-success]="dept.isActive" [class.bg-danger]="!dept.isActive">
            {{ dept.isActive ? 'Yes' : 'No' }}
          </span>
        </td>
        <td class="text-center">
          <button class="btn btn-outline-warning me-1" (click)="editDepartment(dept)">
            <i class="bi bi-pencil-fill"></i>
          </button>
          <button class="btn btn-outline-danger" (click)="deleteDepartment(dept.departmentID)">
            <i class="bi bi-trash-fill"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
