<div class="container mt-5">
  <div class="row g-4">

    <!-- Supplier Form -->
    <div class="col-12">
      <div class="form-container p-4 rounded shadow-sm bg-light">
        <h2>Supplier Master</h2>
        <form #supplierForm="ngForm">

          <!-- Row 1: Code, Name, Phone -->
          <div class="form-row-three">
            <div class="form-column">
              <label for="supplierCode">Code</label>
              <input
                type="text"
                id="supplierCode"
                class="form-control"
                [(ngModel)]="supplier.supplierCode"
                name="supplierCode"
                readonly
                appInputRestrict="text"
                appFocusOnKey targetId="supplierName" [autoFocus]="true"
              />
            </div>

            <div class="form-column">
              <label for="supplierName" class="required">Name</label>
              <input
                type="text"
                id="supplierName"
                class="form-control"
                [(ngModel)]="supplier.supplierName"
                name="supplierName"
                required
                appInputRestrict="letter"
                appFocusOnKey targetId="phone"
                (ngModelChange)="checkDuplicate()"
              />
              <small *ngIf="duplicateError" class="text-danger">
                Supplier Name already exists!
              </small>
            </div>

            <div class="form-column">
              <label for="phone">Phone</label>
              <input
                type="text"
                id="phone"
                class="form-control"
                [(ngModel)]="supplier.phone"
                name="phone"
                appInputRestrict="number"
                appFocusOnKey targetId="alternatePhone"
              />
            </div>
          </div>

          <!-- Row 2: Alt Phone, Email, GST -->
          <div class="form-row-three">
            <div class="form-column">
              <label for="alternatePhone">Alt Phone</label>
              <input
                type="text"
                id="alternatePhone"
                class="form-control"
                [(ngModel)]="supplier.alternatePhone"
                name="alternatePhone"
                appInputRestrict="number"
                appFocusOnKey targetId="email"
              />
            </div>

            <div class="form-column">
              <label for="email">Email</label>
              <input
                type="email"
                id="email"
                class="form-control"
                [(ngModel)]="supplier.email"
                name="email"
                appInputRestrict="email"
                appFocusOnKey targetId="gstNumber"
              />
            </div>

            <div class="form-column">
              <label for="gstNumber">GST Number</label>
              <input
                type="text"
                id="gstNumber"
                class="form-control"
                [(ngModel)]="supplier.gstNumber"
                name="gstNumber"
                appInputRestrict="text"
                appFocusOnKey targetId="postalCode"
              />
            </div>
          </div>

          <!-- Row 3: Postal, Address1, Address2 -->
          <div class="form-row-three">
            <div class="form-column">
              <label for="postalCode">Postal</label>
              <input
                type="text"
                id="postalCode"
                class="form-control"
                [(ngModel)]="supplier.postalCode"
                name="postalCode"
                appInputRestrict="number"
                appFocusOnKey targetId="addressLine1"
              />
            </div>

            <div class="form-column">
              <label for="addressLine1">Address 1</label>
              <input
                type="text"
                id="addressLine1"
                class="form-control"
                [(ngModel)]="supplier.addressLine1"
                name="addressLine1"
                appInputRestrict="address"
                appFocusOnKey targetId="addressLine2"
              />
            </div>

            <div class="form-column">
              <label for="addressLine2">Address 2</label>
              <input
                type="text"
                id="addressLine2"
                class="form-control"
                [(ngModel)]="supplier.addressLine2"
                name="addressLine2"
                appInputRestrict="address"
                appFocusOnKey targetId="city"
              />
            </div>
          </div>

          <!-- Row 4: City, State, Country -->
          <div class="form-row-three">
            <div class="form-column">
              <label for="city">City</label>
              <input
                type="text"
                id="city"
                class="form-control"
                [(ngModel)]="supplier.city"
                name="city"
                appInputRestrict="letter"
                appFocusOnKey targetId="state"
              />
            </div>

            <div class="form-column">
              <label for="state">State</label>
              <input
                type="text"
                id="state"
                class="form-control"
                [(ngModel)]="supplier.state"
                name="state"
                appInputRestrict="letter"
                appFocusOnKey targetId="country"
              />
            </div>

            <div class="form-column">
              <label for="country">Country</label>
              <input
                type="text"
                id="country"
                class="form-control"
                [(ngModel)]="supplier.country"
                name="country"
                appInputRestrict="letter"
                appFocusOnKey targetId="isActive"
              />
            </div>
          </div>

          <!-- Row 5: Active & Save -->
          <div class="form-row-three align-items-center">
            <div class="form-column d-flex align-items-center">
              <input
                type="checkbox"
                id="isActive"
                [(ngModel)]="supplier.isActive"
                name="isActive"
                appFocusOnKey targetId="saveBtn"
              />
              <label for="isActive">Active</label>
            </div>

            <div class="form-column">
              <button
                type="button"
                id="saveBtn"
                class="btn btn-primary w-100"
                (click)="saveOrUpdateSupplier()"
                [disabled]="supplierForm.invalid || duplicateError"
              >
                {{ supplier.supplierID ? 'Update' : 'Save' }}
              </button>
            </div>
          </div>

        </form>
      </div>
    </div>

    <!-- Supplier Table -->
    <div class="col-12 mt-4">
      <div class="table-container">
        <table class="table table-bordered table-hover table-common">
          <thead>
            <tr>
              <th>#</th>
              <th>Code</th>
              <th>Name</th>
              <th>Phone</th>
              <th>Alt Phone</th>
              <th>Email</th>
              <th>GST</th>
              <th>City</th>
              <th>State</th>
              <th>Country</th>
              <th>Postal</th>
              <th>Status</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let s of suppliers; let i = index" [class.table-warning]="supplier.supplierID === s.supplierID">
              <td>{{ i + 1 }}</td>
              <td>{{ s.supplierCode }}</td>
              <td>{{ s.supplierName }}</td>
              <td>{{ s.phone }}</td>
              <td>{{ s.alternatePhone }}</td>
              <td>{{ s.email }}</td>
              <td>{{ s.gstNumber }}</td>
              <td>{{ s.city }}</td>
              <td>{{ s.state }}</td>
              <td>{{ s.country }}</td>
              <td>{{ s.postalCode }}</td>
              <td><span class="badge" [ngClass]="s.isActive ? 'bg-success' : 'bg-danger'">{{ s.isActive ? 'Active' : 'Inactive' }}</span></td>
              <td class="text-center">
                <button class="btn btn-sm btn-primary me-1" (click)="editSupplier(s)"><i class="bi bi-pencil-fill"></i></button>
                <button class="btn btn-sm btn-danger" (click)="deleteSupplier(s)"><i class="bi bi-trash-fill"></i></button>
              </td>
            </tr>
            <tr *ngIf="suppliers.length === 0">
              <td colspan="13" class="text-center text-muted">No suppliers found.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>
</div>
