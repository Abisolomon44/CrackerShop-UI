<div class="container mt-5">
  <div class="row g-4">

    <!-- Customer Form -->
    <div class="col-12">
      <div class="form-container p-4 rounded shadow-sm bg-light">
        <h2>Customer Master</h2>
        <form #customerForm="ngForm">

          <!-- Row 1: Code, Name, Phone -->
          <div class="form-row-three">
            <div class="form-column">
              <label for="customerCode">Code</label>
              <input
                type="text"
                id="customerCode"
                class="form-control"
                [(ngModel)]="customer.customerCode"
                name="customerCode"
                readonly
                appInputRestrict="text"
                appFocusOnKey targetId="customerName" [autoFocus]="true"
              />
            </div>

            <div class="form-column">
              <label for="customerName" class="required">Name</label>
              <input
                type="text"
                id="customerName"
                class="form-control"
                [(ngModel)]="customer.customerName"
                name="customerName"
                required
                appInputRestrict="letter"
                appFocusOnKey targetId="phone"
                (ngModelChange)="checkDuplicate()"
              />
              <small *ngIf="duplicateError" class="text-danger">
                Customer Name already exists!
              </small>
            </div>

            <div class="form-column">
              <label for="phone">Phone</label>
              <input
                type="text"
                id="phone"
                class="form-control"
                [(ngModel)]="customer.phone"
                name="phone"
                appInputRestrict="number"
                appFocusOnKey targetId="alternatePhone"
              />
            </div>
          </div>

          <!-- Row 2: Alt Phone, Email, Postal -->
          <div class="form-row-three">
            <div class="form-column">
              <label for="alternatePhone">Alt Phone</label>
              <input
                type="text"
                id="alternatePhone"
                class="form-control"
                [(ngModel)]="customer.alternatePhone"
                name="alternatePhone"
                appInputRestrict="number"
                appFocusOnKey targetId="email"
              />
            </div>

            <div class="form-column">
              <label for="email">Email</label>
              <input
                type="email"
                id="email"
                class="form-control"
                [(ngModel)]="customer.email"
                name="email"
                appInputRestrict="email"
                appFocusOnKey targetId="postalCode"
              />
            </div>

            <div class="form-column">
              <label for="postalCode">Postal</label>
              <input
                type="text"
                id="postalCode"
                class="form-control"
                [(ngModel)]="customer.postalCode"
                name="postalCode"
                appInputRestrict="number"
                appFocusOnKey targetId="addressLine1"
              />
            </div>
          </div>

          <!-- Row 3: Address1, Address2, City -->
          <div class="form-row-three">
            <div class="form-column">
              <label for="addressLine1">Address 1</label>
              <input
                type="text"
                id="addressLine1"
                class="form-control"
                [(ngModel)]="customer.addressLine1"
                name="addressLine1"
                appInputRestrict="address"
                appFocusOnKey targetId="addressLine2"
              />
            </div>

            <div class="form-column">
              <label for="addressLine2">Address 2</label>
              <input
                type="text"
                id="addressLine2"
                class="form-control"
                [(ngModel)]="customer.addressLine2"
                name="addressLine2"
                appInputRestrict="address"
                appFocusOnKey targetId="city"
              />
            </div>

            <div class="form-column">
              <label for="city">City</label>
              <input
                type="text"
                id="city"
                class="form-control"
                [(ngModel)]="customer.city"
                name="city"
                appInputRestrict="letter"
                appFocusOnKey targetId="state"
              />
            </div>
          </div>

          <!-- Row 4: State, Country, Active -->
          <div class="form-row-three align-items-center">
            <div class="form-column">
              <label for="state">State</label>
              <input
                type="text"
                id="state"
                class="form-control"
                [(ngModel)]="customer.state"
                name="state"
                appInputRestrict="letter"
                appFocusOnKey targetId="country"
              />
            </div>

            <div class="form-column">
              <label for="country">Country</label>
              <input
                type="text"
                id="country"
                class="form-control"
                [(ngModel)]="customer.country"
                name="country"
                appInputRestrict="letter"
                appFocusOnKey targetId="isActive"
              />
            </div>

            <div class="form-column d-flex align-items-center">
              <input
                type="checkbox"
                id="isActive"
                [(ngModel)]="customer.isActive"
                name="isActive"
                appFocusOnKey targetId="saveBtn"
              />
              <label for="isActive">Active</label>
            </div>
          </div>

          <!-- Row 5: Save Button -->
          <div class="form-row-three">
            <div class="form-column">
              <button
                type="button"
                id="saveBtn"
                class="btn btn-primary w-100"
                (click)="saveOrUpdateCustomer()"
                [disabled]="customerForm.invalid || duplicateError"
              >
                {{ customer.customerID ? 'Update' : 'Save' }}
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- Customer Table -->
    <div class="col-12 mt-4">
      <div class="table-container">
        <table class="table table-bordered table-hover table-common">
          <thead>
            <tr>
              <th>#</th>
              <th>Code</th>
              <th>Name</th>
              <th>Phone</th>
              <th>Alt Phone</th>
              <th>Email</th>
              <th>City</th>
              <th>State</th>
              <th>Country</th>
              <th>Postal</th>
              <th>Status</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let c of customers; let i = index" [class.table-warning]="customer.customerID === c.customerID">
              <td>{{ i + 1 }}</td>
              <td>{{ c.customerCode }}</td>
              <td>{{ c.customerName }}</td>
              <td>{{ c.phone }}</td>
              <td>{{ c.alternatePhone }}</td>
              <td>{{ c.email }}</td>
              <td>{{ c.city }}</td>
              <td>{{ c.state }}</td>
              <td>{{ c.country }}</td>
              <td>{{ c.postalCode }}</td>
              <td><span class="badge" [ngClass]="c.isActive ? 'bg-success' : 'bg-danger'">{{ c.isActive ? 'Active' : 'Inactive' }}</span></td>
              <td class="text-center">
                <button class="btn btn-sm btn-primary me-1" (click)="editCustomer(c)"><i class="bi bi-pencil-fill"></i></button>
                <button class="btn btn-sm btn-danger" (click)="deleteCustomer(c)"><i class="bi bi-trash-fill"></i></button>
              </td>
            </tr>
            <tr *ngIf="customers.length === 0">
              <td colspan="12" class="text-center text-muted">No customers found.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>
</div>
